<nav class="navbar navbar-expand-sm navbar-light bg-light" id="ournav" hx-target="#anchor">

    <div class="container-fluid">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText"
            aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav nav-fill w-100" id="navlist">
                <li class="nav-item"><a class="nav-link" href="/calendar/">calendar</a></li>
                <li class="nav-item"><a class="nav-link" href="/photos/">pictures</a></li>
                <li class="nav-item"><button id="loginlogoutnav" class="nav-link"
                        onclick='{loginModal.toggle(); showLoginForm()}'>login</button>
                </li>
            </ul>
        </div>
        <p onclick='scrollToTop()' class="btn" hx-get="/get-posts" style="display: contents;" hx-trigger="click"
            hx-target="#post-items" style="color: blue;" id="notification"></p>
    </div>
</nav>
<div class="modal" tabindex="-1" id="login-modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" style="text-align: center;">Login or Sign Up</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div style="display: flex; justify-content: space-around;">
                    <button class="btn px-5 btn-outline-secondary" id="login-button"
                        onclick='showLoginForm()'>Login</button>
                    <button class="btn px-5 btn-outline-secondary" id="signup-button"
                        onclick='showSignUpForm()'>Sign-up</button>
                </div>
                <div id="togglesignuplogin">
                    <form class="form" id="login-form" name="loginform" hx-post="/login" hx-trigger="submit"
                        hx-on="loginevent: loginFunction()" hx-swap="none">
                        <div class="p-4">
                            <h5>Login</h5>
                            <label>Username:</label>
                            <input class="form-control" type="text" name="usernamelogin" autocomplete="additional-name"
                                placeholder="Username" oninput="checkForValidLoginSubmission()" required
                                id="usernamelogininput" />
                        </div>
                        <div class="p-4">
                            <label>Password:</label>
                            <input class="form-control" name="passwordlogin" type="password" autocomplete="new-password"
                                placeholder="Password" oninput="checkForValidLoginSubmission()" required
                                id="passwordlogininput" />
                        </div>
                    </form>
                    <form class="form" id="sign-up-form" name="signupform" hx-post="/signup" hx-trigger="submit"
                        hx-encoding="multipart/form-data" hx-swap="none">
                        <div class="p-4">
                            <h5>Sign Up</h5>
                            <label>Username:</label>
                            <input class="form-control" type="text" name="usernamesignup" autocomplete="additional-name"
                                placeholder="Username" oninput="checkForValidSignUpSubmission()" required
                                id="usernamesignupinput" />
                        </div>
                        <div class="p-4">
                            <label>Password:</label>
                            <input class="form-control" type="password" name="passwordsignup"
                                autocomplete="new-password" placeholder="Password"
                                oninput="checkForValidSignUpSubmission()" required id="passwordsignupinput" />
                        </div>
                        <div class="p-4">
                            <label>Confirm Password:</label>
                            <input class="form-control" type="password" autocomplete="new-password"
                                placeholder="Password" oninput="checkForValidSignUpSubmission()" required
                                id="confirmpasswordsignupinput" />
                        </div>
                        <div class="p-4">
                            <label>Pick a profile picture</label>
                            <input id="pfpimage" type="file" accept="image/*" name="pfpformfile" />

                        </div>
                    </form>
                </div>

            </div>

        </div>
    </div>

</div>
<script>

    let p = document.getElementById('anchor')
    let c = document.getElementById('ournav')

    let signup = document.getElementById('sign-up-form')
    let loginele = document.getElementById('login-form')
    let parentauth = document.getElementById('togglesignuplogin')

    let loginbtn = document.getElementById('login-button')
    let signupbtn = document.getElementById('signup-button')

    let gologin = document.createElement('button')
    let gosignup = document.createElement('button')

    let usernamelogininput = document.getElementById('usernamelogininput')
    let passwordlogininput = document.getElementById('passwordlogininput')

    let usernamesignupinput = document.getElementById('usernamesignupinput')
    let passwordsignupinput = document.getElementById('passwordsignupinput')
    let confirmpasswordsignupinput = document.getElementById('confirmpasswordsignupinput')

    var loginModal = new bootstrap.Modal(document.getElementById('login-modal'), {});

    p.append(c)

    function showSignUpForm() {

        if (parentauth.childElementCount >= 1) {
            signupbtn.setAttribute('class', 'btn px-5 btn-secondary')

            loginbtn.setAttribute('class', 'btn px-5 btn-outline-secondary')
            if (parentauth.contains(loginele)) {
                parentauth.removeChild(loginele)
            }
            parentauth.appendChild(signup)
        }
    }
    function showLoginForm() {

        if (parentauth.childElementCount >= 1) {
            loginbtn.setAttribute('class', 'btn px-5 btn-secondary')
            signupbtn.setAttribute('class', 'btn px-5 btn-outline-secondary')
            if (parentauth.contains(signup)) {
                parentauth.removeChild(signup)
            }
            parentauth.appendChild(loginele)
        }
    }
    function checkForValidLoginSubmission() {

        if (usernamelogininput.value > '' && passwordlogininput.value > '') {

            gologin.setAttribute("type", "submit")
            gologin.setAttribute("class", "btn btn-outline-success")
            gologin.setAttribute("data-bs-dismiss", "modal")

            gologin.innerHTML = "Go!"

            loginele.append(gologin)
        } else if ((usernamelogininput.value == '' || passwordlogininput.value == '') && loginele.contains(gologin)) {
            loginele.removeChild(gologin)
        }
    }
    function checkForValidSignUpSubmission() {
        if (usernamesignupinput.value > '' && passwordsignupinput.value > '' && passwordsignupinput.value === confirmpasswordsignupinput.value) {

            gosignup.setAttribute("type", "submit")
            gosignup.setAttribute("class", "btn btn-outline-success")
            gosignup.setAttribute("data-bs-dismiss", "modal")

            gosignup.innerHTML = "Go!"

            signup.append(gosignup)

        } else if ((usernamesignupinput.value == '' || passwordsignupinput.value == '' || confirmpasswordsignupinput.value == '' || passwordsignupinput.value !== confirmpasswordsignupinput.value) && signup.contains(gosignup)) {

            signup.removeChild(gosignup)

        }
    }

    function loginFunction() {

        alert("username or password incorrect")
        loginModal.toggle()
        showLoginForm()
    }

    function imageLoad() {
        alert("test")
    }

</script>