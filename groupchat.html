<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" crossorigin="use-credentials" href="manifest.webmanifest" />
    <!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>-->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="js/bootstrap.bundle.min.js"></script>
    <!--<script src="https://unpkg.com/htmx.org@1.9.5"
            integrity="sha384-xcuj3WpfgjlKF+FXhSQFQ0ZNr39ln+hwjN3npfM9VBnUskLolQAcN80McRIVOPuO"
            crossorigin="anonymous"></script>
            <script src="https://unpkg.com/htmx.org/dist/ext/json-enc.js"></script>-->
    <script src="js/htmx.min.js"></script>
    <script src="js/htmx_json-enc.js"></script>


    <title>The Family Loop - Group Chat</title>
</head>

<body>
    <h3 style="text-align: center;">Group Chat</h3>
    <div id="anchor">

    </div>
    <div hx-get="/group-chat-messages" hx-trigger="load, every 5s, success-send from:#messageform"
        class="border-1 d-block m-2"
        style="justify-content: center; text-align: center; background-color: rgb(205, 205, 206); border-radius: 1%;">

    </div>
    <form hx-post="/create-a-group-chat-message" hx-swap="afterend" hx-target="this"
        hx-on::after-request="clearFormGetMessages()" id="messageform">
        <div class="d-flex" style="justify-content: center; margin-bottom: 8%;">
            <input class="my-0 border-2 text-center" style="border-radius: 3%; width: 75%;" name="gchatmessage"
                id="gchatinput" type="text" placeholder="Enter message" required maxlength="420" />
            <button type="submit" class="btn btn-outline-success"><i class="bi bi-send"></i></button>
        </div>
    </form>
    <script>
        function clearFormGetMessages() {
            document.getElementById('gchatinput').value = ""
        }
        htmx.on('#messageform', 'htmx:afterRequest', function (event) {
            event.detail.xhr.status === 401
                && alert("Please login first.")
        })
    </script>
</body>


</html>